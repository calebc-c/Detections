# IIS Exploit Attempts - SharePoint ToolPane exploitation
let iis_exploit_attempts = 
#event_simpleName=HTTPRequest
| regex("/_layouts/15/ToolPane\.aspx", field=Uri, strict=false)
| (Uri contains "DisplayMode=Edit" or Uri contains "/_layouts/15/upload.aspx")
| (Method in ["POST", "PUT", "OPTIONS"])
| eval detection_type="SharePoint_ToolPane_Exploit"
| select([timestamp, ComputerName, RemoteIP, LocalIP, Uri, Method, UserAgent, detection_type]);